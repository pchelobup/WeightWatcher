DROP TABLE IF EXISTS user_roles;
DROP TABLE IF EXISTS notation;
DROP TABLE IF EXISTS users;
DROP TABLE IF EXISTS GLOBAL_SEQ;

CREATE SEQUENCE GLOBAL_SEQ AS INTEGER START WITH 1000;


CREATE TABLE users
(
    id             INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,
    email          VARCHAR(30) NOT NULL UNIQUE,
    password       VARCHAR(1000) NOT NULL,
    registered     TIMESTAMP DEFAULT now(),
    gender         VARCHAR(6),
    height         INTEGER     NOT NULL,
    age            INTEGER     NOT NULL,
    activity       VARCHAR(6)  NOT NULL,
    start_weight   DOUBLE      NOT NULL,
    desired_weight DOUBLE      NOT NULL,
    calories       INTEGER

);

CREATE TABLE user_roles
(
    user_id INTEGER NOT NULL,
    role    VARCHAR(255),
    CONSTRAINT user_roles_idx UNIQUE (user_id, role),
    FOREIGN KEY (user_id) REFERENCES USERS (id) ON DELETE CASCADE
);

CREATE TABLE notation
(
    id      INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,
    user_id INTEGER NOT NULL,
    added   DATE    NOT NULL,
    weight  DOUBLE  NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE
)

